<div class="card shadow-sm p-2 mb-3  rounded" style="max-width: 490px;margin: auto; background-color: #d4d4d3;" >
 
  <form (ngSubmit)="submitLeave()" #leaveForm="ngForm" class="leave-form" style="background-color:white;">
      <!-- Logo -->
      <div class="text-end mb-2">
        <a [routerLink]="['/worklog']">
          <img src="assets/logo.png" alt="Logo" style="width: 100px; height: auto; cursor: pointer;">
        </a>
      </div>
     <!-- Timer + User -->
     <div class="d-flex justify-content-between align-items-center mb-0" style="padding-left: 0;">
  
      <!-- User Avatar (Profile or Initials) -->
      <div class="position-relative" style="padding-left: 0;">
        <label for="profileInput" class="d-block">
          <div
            class="bg-secondary text-white rounded-circle d-flex justify-content-center align-items-center overflow-hidden"
            style="width: 110px; height: 110px; font-size: 3rem;"
            title="Click to upload/remove profile picture"
          >
            <img *ngIf="profileImageUrl" [src]="profileImageUrl" alt="Profile" class="w-100 h-100 object-fit-cover">
            <span *ngIf="!profileImageUrl">{{ userInitials }}</span>
          </div>
        </label>
      </div>
    </div>


    <!--Username -->
    <div class="d-flex align-items-center justify-content-between mb-1 mt-1">
      <div>
        <h5 class="mb-0">{{ username }}</h5>
      </div>
    </div>


  
      <div class="form-group pt-3">
        <label for="reason">Reason</label>
        <textarea
          id="reason"
          placeholder="Reason for Leave"
          [(ngModel)]="leaveData.reason"
          name="reason"
          required
        ></textarea>
      </div>
      
      <div class="form-group permission-group">
        <input type="checkbox" id="isPermission" [(ngModel)]="isPermission" name="isPermission" />
        <label for="isPermission">Permission</label>
      </div>
      
      <!-- Show date fields if NOT permission -->
      <div *ngIf="!isPermission">
        <!-- Start Date -->
<div class="form-group">
  <label for="startDate">Start Date</label>
  <input
    type="date"
    id="startDate"
    [(ngModel)]="leaveData.startDate"
    name="startDate"
    [min]="todayDate"  
    required
  />
</div>

<!-- End Date -->
<div class="form-group">
  <label for="endDate">End Date</label>
  <input
    type="date"
    id="endDate"
    [(ngModel)]="leaveData.endDate"
    name="endDate"
    [min]="leaveData.startDate || todayDate" 
    [max]="getMaxEndDate()"
    required
  />
</div>

      </div>
      
      <!-- Show time fields if permission -->
      <div *ngIf="isPermission">
        <div class="form-group">
          <label for="startTime">Start Time</label>
          <input
            type="time"
            id="startTime"
            [(ngModel)]="leaveData.startTime"
            name="startTime"
            required
          />
        </div>
      
        <div class="form-group">
          <label for="endTime">End Time</label>
          <input
            type="time"
            id="endTime"
            [(ngModel)]="leaveData.endTime"
            name="endTime"
            required
          />
        </div>
      </div>
  
      <div class="form-group">
        <button type="submit" [disabled]="leaveForm.invalid">Submit</button>
      </div>
    </form>
    
    
    </div>
  

<ng-template #loadingSSR>
  <div class="container">
    <h2>ðŸ•— Loading Leave Request...</h2>
    <p>This page is not fully interactive yet. Please wait or view in the browser.</p>
  </div>
</ng-template>
